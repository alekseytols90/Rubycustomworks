<%= render "shared/errors", object: @membership %>

<fieldset>
<div class="form-group">
	<div class="col-sm-9 lead">
		<% if @membership.person_id.blank? %>
			<h3>New Member</h3>
		<% else %>
			<h4><%= @membership.person.name %>'s <%= @event.code %> Membership Details</h4>
			<%= f.hidden_field :person_id %>
		<% end %>
	</div>
</div>

<%= f.fields_for @membership.person do |person| %>
<div class="form-group">
	<div class="col-sm-3 control-label">
		<%= person.label :salutation, "Salutation: " %>
	</div>
	<div class="col-sm-2">
		<%= person.select :salutation, Setting.Site['salutations'], {},
			{ required: 'true', autofocus: 'true', class: 'form-control' } %>
	</div>
	<div class="col-sm-7"></div>
</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :firstname, "Firstname: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :firstname, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :lastname, "Lastname: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :lastname, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :email, "E-mail: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :email, class: 'form-control' %>
		</div>
		<div class="form-inline member-email">
			<div class="col-sm-3">
				&nbsp;
			</div>
			<div class="col-sm-9 share_email">
				<%= f.check_box 'share_email', class: "form-control" %>
				<%= f.label(:share_email, 'Allow other members of the event to see this e-mail address') %>
			</div>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :phone, "Phone: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :phone, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :url, "Website: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :url, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :gender, "Gender: " %>
		</div>
		<div class="col-sm-3">
			<%= person.select :gender, {"Male" => "M", "Female" => "F"}, {}, { required: 'true', autofocus: 'true', class: 'form-control' } %>
		</div>
		<div class="col-sm-6"></div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :affiliation, "Affiliation: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :affiliation, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :department, "Department: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :department, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :title, "Title: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :title, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :academic_status, "Academic Status: " %>
		</div>
		<div class="col-sm-3">
			<%= person.select :academic_status, Setting.Site['academic_status'], {}, { required: 'true', autofocus: 'true', class: 'form-control' } %>
		</div>
		<div class="col-sm-6"></div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :research_areas, "Research Areas: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_field :research_areas, class: 'form-control' %>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= person.label :biograhy, "Biography: " %>
		</div>
		<div class="col-sm-9">
			<%= person.text_area :biography, class: 'form-control' %>
		</div>
	</div>

<% end %>

<div class="form-group">
	<div class="col-sm-3 control-label">
		<%= f.label :role, "Role: " %>
	</div>
	<div class="col-sm-3">
		<%= show_roles(f) %>
	</div>
	<div class="col-sm-6"></div>
</div>

<% if user_is_admin? || user_is_this?(@membership.person) %>
	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= f.label :arrival_date, "Arrival Date: " %>
		</div>
		<div class="col-sm-3 input-group date" id="datetimepicker1" data-date="<%= @arrival_date %>" data-date-format="yyyy-mm-dd">
			<%= f.text_field :arrival_date, size: 8, class: "form-control dates", value: @arrival_date %>
			<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
		</div>
	</div>

	<div class="form-group">
		<div class="col-sm-3 control-label">
			<%= f.label :departure_date, "Departure Date: " %>
		</div>
		<div class="col-sm-3 input-group date" id="datetimepicker2" data-date="<%= @departure_date %>" data-date-format="yyyy-mm-dd">
			<%= f.text_field :departure_date, size: 8, class: "form-control dates", value: @departure_date %>
			<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
		</div>
	</div>
<% end %>

<div class="form-group">
	<div class="col-sm-3 control-label">
		<%= f.label :attendance, "Attendance: " %>
	</div>
	<div class="col-sm-3">
		<%= show_attendance(f) %>
	</div>
	<div class="col-sm-6"></div>
</div>

<div class="form-group">
	<div class="col-sm-3"></div>
	<div class="col-sm-9" id="member-buttons">
	<%= f.submit @button_text, class: 'btn btn-sm btn-default' %>
	<% if request.fullpath.match(/.+\/edit$/) && user_is_organizer? %>
		| <%= link_to 'Delete Membership', event_membership_path(@event, @membership), method: :delete, class: 'btn btn-sm btn-default', data: { confirm: "Are you sure you want to remove #{@membership.person.name} from #{@event.code}?" } %>
		| <%= link_to "Back to Profile", event_membership_path(@event, @membership), class: 'btn btn-sm btn-default' %>
	<% else %>
	<%= f.submit "Back", :name => "back_button", class: 'btn btn-sm btn-default' unless @membership.first_step? %>

	<% end %>
	</div>
</div>
</fieldset>
